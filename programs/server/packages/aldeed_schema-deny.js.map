{"version":3,"sources":["meteor://ðŸ’»app/packages/aldeed_schema-deny/lib/deny.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/packages/aldeed_schema-deny.js","sourcesContent":["// Extend the schema options allowed by SimpleSchema\nSimpleSchema.extendOptions({\n  denyInsert: Match.Optional(Boolean),\n  denyUpdate: Match.Optional(Boolean),\n});\n\n// Define validation error messages\nSimpleSchema.messages({\n  insertNotAllowed: \"[label] cannot be set during an insert\",\n  updateNotAllowed: \"[label] cannot be set during an update\"\n});\n\nCollection2.on('schema.attached', function (collection, ss) {\n  ss.addValidator(function() {\n    if (!this.isSet) return;\n\n    var def = this.definition;\n\n    if (def.denyInsert && this.isInsert) return \"insertNotAllowed\";\n    if (def.denyUpdate && (this.isUpdate || this.isUpsert)) return \"updateNotAllowed\";\n  });\n});\n"]}